\hypertarget{namespace_p_i_c}{}\section{P\+IC Namespace Reference}
\label{namespace_p_i_c}\index{P\+IC@{P\+IC}}


8259 Progammable interrupt controller  


\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{namespace_p_i_c_a2a04fe95329faacc43f00ad30fe554b9}{Remap} ()
\begin{DoxyCompactList}\small\item\em Remap default 8259 \hyperlink{namespace_p_i_c}{P\+IC} interrupt number to new range. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const uint8\+\_\+t \hyperlink{namespace_p_i_c_aae56765eb24eb75e1498e22c05ac29ee}{M\+A\+S\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+D\+\_\+\+P\+O\+RT} = 0x20
\begin{DoxyCompactList}\small\item\em P\+I\+C1 command port. \end{DoxyCompactList}\item 
const uint8\+\_\+t \hyperlink{namespace_p_i_c_a7b19e701740b8b1b19db1f1a14af63a6}{M\+A\+S\+T\+E\+R\+\_\+\+D\+A\+T\+A\+\_\+\+P\+O\+RT} = 0x21
\begin{DoxyCompactList}\small\item\em P\+I\+C1 data port. \end{DoxyCompactList}\item 
const uint8\+\_\+t \hyperlink{namespace_p_i_c_a4cdc374612119bd13b1a28e4cc82864f}{S\+L\+A\+V\+E\+\_\+\+C\+O\+M\+M\+A\+N\+D\+\_\+\+P\+O\+RT} = 0x\+A0
\begin{DoxyCompactList}\small\item\em P\+I\+C2 command port. \end{DoxyCompactList}\item 
const uint8\+\_\+t \hyperlink{namespace_p_i_c_a6e06fae4a0139a207173ff2b94be3283}{S\+L\+A\+V\+E\+\_\+\+D\+A\+T\+A\+\_\+\+P\+O\+RT} = 0x\+A1
\begin{DoxyCompactList}\small\item\em P\+I\+C2 data port. \end{DoxyCompactList}\item 
const uint8\+\_\+t \hyperlink{namespace_p_i_c_a63beb0c60fdab8c997f42291a7c2baf5}{I\+C\+W1\+\_\+\+I\+C\+W4\+N\+E\+E\+D\+ED} = 0x1
\begin{DoxyCompactList}\small\item\em expect I\+CW 4 \end{DoxyCompactList}\item 
const uint8\+\_\+t \hyperlink{namespace_p_i_c_a8bb2fc0a772eabbbf6adb002f578290e}{I\+C\+W1\+\_\+\+I\+N\+IT} = 0x10
\begin{DoxyCompactList}\small\item\em initialize \hyperlink{namespace_p_i_c}{P\+IC} \end{DoxyCompactList}\item 
const uint8\+\_\+t \hyperlink{namespace_p_i_c_aa3b99beaed95a8a51f1e855723e05d48}{I\+C\+W1\+\_\+\+C\+O\+N\+F\+IG} = \hyperlink{namespace_p_i_c_a63beb0c60fdab8c997f42291a7c2baf5}{I\+C\+W1\+\_\+\+I\+C\+W4\+N\+E\+E\+D\+ED} $\vert$ \hyperlink{namespace_p_i_c_a8bb2fc0a772eabbbf6adb002f578290e}{I\+C\+W1\+\_\+\+I\+N\+IT}
\item 
const uint8\+\_\+t \hyperlink{namespace_p_i_c_a4eada3349fe4b6740074b1adecdb080b}{I\+C\+W2\+\_\+\+M\+A\+S\+T\+E\+R\+\_\+\+O\+F\+F\+S\+ET} = 0x20
\begin{DoxyCompactList}\small\item\em I\+VT 0-\/31 are reserved for intel exception. \end{DoxyCompactList}\item 
const uint8\+\_\+t \hyperlink{namespace_p_i_c_a33b48f750baf61bf1820e5b36ce44a48}{I\+C\+W2\+\_\+\+S\+L\+A\+V\+E\+\_\+\+O\+F\+F\+S\+ET} = 0x28
\begin{DoxyCompactList}\small\item\em master handles I\+R\+Q0-\/7 (I\+VT 0x20), slave handles I\+R\+Q8-\/15 (I\+VT 0x28) \end{DoxyCompactList}\item 
const uint8\+\_\+t \hyperlink{namespace_p_i_c_ade78b65e9f0859d0d5ca14df7148b305}{I\+C\+W3\+\_\+\+M\+A\+S\+T\+E\+R\+\_\+\+S\+L\+A\+V\+E\+\_\+\+P\+OS} = 0x4
\begin{DoxyCompactList}\small\item\em tells master that slave is in 3rd position (I\+R\+Q2) \end{DoxyCompactList}\item 
const uint8\+\_\+t \hyperlink{namespace_p_i_c_abe9c403a4caa1dd885595bd27c803122}{I\+C\+W3\+\_\+\+S\+L\+A\+V\+E\+\_\+\+ID} = 0x2
\begin{DoxyCompactList}\small\item\em tells slave that it is assigned as I\+R\+Q2 on master \end{DoxyCompactList}\item 
const uint8\+\_\+t \hyperlink{namespace_p_i_c_a3d092deea6581b86dddc5fb5c7fde403}{I\+C\+W4\+\_\+\+C\+PU} = 0x1
\begin{DoxyCompactList}\small\item\em 8086/8088 mode \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
8259 Progammable interrupt controller 

\begin{DoxySeeAlso}{See also}
\href{http://www.brokenthorn.com/Resources/OSDevPic.html}{\tt Broken Thorn\textquotesingle{}s remapping P\+IC}
\end{DoxySeeAlso}
\begin{DoxyVerb}ICW1 to configure PIC
| bit | on (off)                        |
|   0 | expect ICW 4 (not expect)       |
|   1 | cascade with slave (only 1 PIC) |
|   2 | 8 byte interval (4 byte)        |
|   3 | edge triggered (level)          |
|   4 | initialize PIC (not initialize) |
| 5-7 | zero for x86                    |

ICW2 to map base IRQ address to PIC
| bit | description                                                                         |
| 0-7 | specifies start of interrupt number, must be byte aligned on x86, thus 0-3 not used |

ICW3 to specify relationship of master/slave to slave/master
    Master
    | bit | description                     |
    | 0-7 | IRQ position connected to slave |

    Slave
    | bit | description                                  |
    | 0-2 | IRQ number assigned by master, starts from 1 |
    | 3-7 | must be zero                                 |

ICW4 to specify PIC operation
| bit | on (off)                                  |
|   0 | MCS-80/86 mode (x86 mode)                 |
|   1 | perform EOI on last interrupt acknowledge |
| 2-4 | not used                                  |
| 5-7 | must be 0                                 |
\end{DoxyVerb}
 

\subsection{Function Documentation}
\mbox{\Hypertarget{namespace_p_i_c_a2a04fe95329faacc43f00ad30fe554b9}\label{namespace_p_i_c_a2a04fe95329faacc43f00ad30fe554b9}} 
\index{P\+IC@{P\+IC}!Remap@{Remap}}
\index{Remap@{Remap}!P\+IC@{P\+IC}}
\subsubsection{\texorpdfstring{Remap()}{Remap()}}
{\footnotesize\ttfamily void P\+I\+C\+::\+Remap (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Remap default 8259 \hyperlink{namespace_p_i_c}{P\+IC} interrupt number to new range. 

In protected mode,~\newline
Bios sets master \hyperlink{namespace_p_i_c}{P\+IC} interrupt number to 0x8\+:0xF~\newline
Bios sets slave \hyperlink{namespace_p_i_c}{P\+IC} interrupt number to 0x70\+:0x77~\newline
However master\textquotesingle{}s 0x8\+:0xF clashes with Intel reserved exception from 0x0\+:0x1F Thus we remap \hyperlink{namespace_p_i_c}{P\+IC}\textquotesingle{}s interrupt number to 0x20\+:0x27 (master) and 0x28\+:0x2F While we only care about I\+C\+W2, resetting \hyperlink{namespace_p_i_c}{P\+IC} requires specifying all I\+C\+W1-\/4 \begin{DoxySeeAlso}{See also}
\href{https://wiki.osdev.org/8259_PIC#Protected_Mode}{\tt Remapping P\+IC on protected mode} 
\end{DoxySeeAlso}


Definition at line 84 of file interrupt.\+cpp.



\subsection{Variable Documentation}
\mbox{\Hypertarget{namespace_p_i_c_aa3b99beaed95a8a51f1e855723e05d48}\label{namespace_p_i_c_aa3b99beaed95a8a51f1e855723e05d48}} 
\index{P\+IC@{P\+IC}!I\+C\+W1\+\_\+\+C\+O\+N\+F\+IG@{I\+C\+W1\+\_\+\+C\+O\+N\+F\+IG}}
\index{I\+C\+W1\+\_\+\+C\+O\+N\+F\+IG@{I\+C\+W1\+\_\+\+C\+O\+N\+F\+IG}!P\+IC@{P\+IC}}
\subsubsection{\texorpdfstring{I\+C\+W1\+\_\+\+C\+O\+N\+F\+IG}{ICW1\_CONFIG}}
{\footnotesize\ttfamily const uint8\+\_\+t P\+I\+C\+::\+I\+C\+W1\+\_\+\+C\+O\+N\+F\+IG = \hyperlink{namespace_p_i_c_a63beb0c60fdab8c997f42291a7c2baf5}{I\+C\+W1\+\_\+\+I\+C\+W4\+N\+E\+E\+D\+ED} $\vert$ \hyperlink{namespace_p_i_c_a8bb2fc0a772eabbbf6adb002f578290e}{I\+C\+W1\+\_\+\+I\+N\+IT}}



Definition at line 63 of file interrupt.\+cpp.

\mbox{\Hypertarget{namespace_p_i_c_a63beb0c60fdab8c997f42291a7c2baf5}\label{namespace_p_i_c_a63beb0c60fdab8c997f42291a7c2baf5}} 
\index{P\+IC@{P\+IC}!I\+C\+W1\+\_\+\+I\+C\+W4\+N\+E\+E\+D\+ED@{I\+C\+W1\+\_\+\+I\+C\+W4\+N\+E\+E\+D\+ED}}
\index{I\+C\+W1\+\_\+\+I\+C\+W4\+N\+E\+E\+D\+ED@{I\+C\+W1\+\_\+\+I\+C\+W4\+N\+E\+E\+D\+ED}!P\+IC@{P\+IC}}
\subsubsection{\texorpdfstring{I\+C\+W1\+\_\+\+I\+C\+W4\+N\+E\+E\+D\+ED}{ICW1\_ICW4NEEDED}}
{\footnotesize\ttfamily const uint8\+\_\+t P\+I\+C\+::\+I\+C\+W1\+\_\+\+I\+C\+W4\+N\+E\+E\+D\+ED = 0x1}



expect I\+CW 4 



Definition at line 61 of file interrupt.\+cpp.

\mbox{\Hypertarget{namespace_p_i_c_a8bb2fc0a772eabbbf6adb002f578290e}\label{namespace_p_i_c_a8bb2fc0a772eabbbf6adb002f578290e}} 
\index{P\+IC@{P\+IC}!I\+C\+W1\+\_\+\+I\+N\+IT@{I\+C\+W1\+\_\+\+I\+N\+IT}}
\index{I\+C\+W1\+\_\+\+I\+N\+IT@{I\+C\+W1\+\_\+\+I\+N\+IT}!P\+IC@{P\+IC}}
\subsubsection{\texorpdfstring{I\+C\+W1\+\_\+\+I\+N\+IT}{ICW1\_INIT}}
{\footnotesize\ttfamily const uint8\+\_\+t P\+I\+C\+::\+I\+C\+W1\+\_\+\+I\+N\+IT = 0x10}



initialize \hyperlink{namespace_p_i_c}{P\+IC} 



Definition at line 62 of file interrupt.\+cpp.

\mbox{\Hypertarget{namespace_p_i_c_a4eada3349fe4b6740074b1adecdb080b}\label{namespace_p_i_c_a4eada3349fe4b6740074b1adecdb080b}} 
\index{P\+IC@{P\+IC}!I\+C\+W2\+\_\+\+M\+A\+S\+T\+E\+R\+\_\+\+O\+F\+F\+S\+ET@{I\+C\+W2\+\_\+\+M\+A\+S\+T\+E\+R\+\_\+\+O\+F\+F\+S\+ET}}
\index{I\+C\+W2\+\_\+\+M\+A\+S\+T\+E\+R\+\_\+\+O\+F\+F\+S\+ET@{I\+C\+W2\+\_\+\+M\+A\+S\+T\+E\+R\+\_\+\+O\+F\+F\+S\+ET}!P\+IC@{P\+IC}}
\subsubsection{\texorpdfstring{I\+C\+W2\+\_\+\+M\+A\+S\+T\+E\+R\+\_\+\+O\+F\+F\+S\+ET}{ICW2\_MASTER\_OFFSET}}
{\footnotesize\ttfamily const uint8\+\_\+t P\+I\+C\+::\+I\+C\+W2\+\_\+\+M\+A\+S\+T\+E\+R\+\_\+\+O\+F\+F\+S\+ET = 0x20}



I\+VT 0-\/31 are reserved for intel exception. 



Definition at line 65 of file interrupt.\+cpp.

\mbox{\Hypertarget{namespace_p_i_c_a33b48f750baf61bf1820e5b36ce44a48}\label{namespace_p_i_c_a33b48f750baf61bf1820e5b36ce44a48}} 
\index{P\+IC@{P\+IC}!I\+C\+W2\+\_\+\+S\+L\+A\+V\+E\+\_\+\+O\+F\+F\+S\+ET@{I\+C\+W2\+\_\+\+S\+L\+A\+V\+E\+\_\+\+O\+F\+F\+S\+ET}}
\index{I\+C\+W2\+\_\+\+S\+L\+A\+V\+E\+\_\+\+O\+F\+F\+S\+ET@{I\+C\+W2\+\_\+\+S\+L\+A\+V\+E\+\_\+\+O\+F\+F\+S\+ET}!P\+IC@{P\+IC}}
\subsubsection{\texorpdfstring{I\+C\+W2\+\_\+\+S\+L\+A\+V\+E\+\_\+\+O\+F\+F\+S\+ET}{ICW2\_SLAVE\_OFFSET}}
{\footnotesize\ttfamily const uint8\+\_\+t P\+I\+C\+::\+I\+C\+W2\+\_\+\+S\+L\+A\+V\+E\+\_\+\+O\+F\+F\+S\+ET = 0x28}



master handles I\+R\+Q0-\/7 (I\+VT 0x20), slave handles I\+R\+Q8-\/15 (I\+VT 0x28) 



Definition at line 66 of file interrupt.\+cpp.

\mbox{\Hypertarget{namespace_p_i_c_ade78b65e9f0859d0d5ca14df7148b305}\label{namespace_p_i_c_ade78b65e9f0859d0d5ca14df7148b305}} 
\index{P\+IC@{P\+IC}!I\+C\+W3\+\_\+\+M\+A\+S\+T\+E\+R\+\_\+\+S\+L\+A\+V\+E\+\_\+\+P\+OS@{I\+C\+W3\+\_\+\+M\+A\+S\+T\+E\+R\+\_\+\+S\+L\+A\+V\+E\+\_\+\+P\+OS}}
\index{I\+C\+W3\+\_\+\+M\+A\+S\+T\+E\+R\+\_\+\+S\+L\+A\+V\+E\+\_\+\+P\+OS@{I\+C\+W3\+\_\+\+M\+A\+S\+T\+E\+R\+\_\+\+S\+L\+A\+V\+E\+\_\+\+P\+OS}!P\+IC@{P\+IC}}
\subsubsection{\texorpdfstring{I\+C\+W3\+\_\+\+M\+A\+S\+T\+E\+R\+\_\+\+S\+L\+A\+V\+E\+\_\+\+P\+OS}{ICW3\_MASTER\_SLAVE\_POS}}
{\footnotesize\ttfamily const uint8\+\_\+t P\+I\+C\+::\+I\+C\+W3\+\_\+\+M\+A\+S\+T\+E\+R\+\_\+\+S\+L\+A\+V\+E\+\_\+\+P\+OS = 0x4}



tells master that slave is in 3rd position (I\+R\+Q2) 



Definition at line 68 of file interrupt.\+cpp.

\mbox{\Hypertarget{namespace_p_i_c_abe9c403a4caa1dd885595bd27c803122}\label{namespace_p_i_c_abe9c403a4caa1dd885595bd27c803122}} 
\index{P\+IC@{P\+IC}!I\+C\+W3\+\_\+\+S\+L\+A\+V\+E\+\_\+\+ID@{I\+C\+W3\+\_\+\+S\+L\+A\+V\+E\+\_\+\+ID}}
\index{I\+C\+W3\+\_\+\+S\+L\+A\+V\+E\+\_\+\+ID@{I\+C\+W3\+\_\+\+S\+L\+A\+V\+E\+\_\+\+ID}!P\+IC@{P\+IC}}
\subsubsection{\texorpdfstring{I\+C\+W3\+\_\+\+S\+L\+A\+V\+E\+\_\+\+ID}{ICW3\_SLAVE\_ID}}
{\footnotesize\ttfamily const uint8\+\_\+t P\+I\+C\+::\+I\+C\+W3\+\_\+\+S\+L\+A\+V\+E\+\_\+\+ID = 0x2}



tells slave that it is assigned as I\+R\+Q2 on master 



Definition at line 69 of file interrupt.\+cpp.

\mbox{\Hypertarget{namespace_p_i_c_a3d092deea6581b86dddc5fb5c7fde403}\label{namespace_p_i_c_a3d092deea6581b86dddc5fb5c7fde403}} 
\index{P\+IC@{P\+IC}!I\+C\+W4\+\_\+\+C\+PU@{I\+C\+W4\+\_\+\+C\+PU}}
\index{I\+C\+W4\+\_\+\+C\+PU@{I\+C\+W4\+\_\+\+C\+PU}!P\+IC@{P\+IC}}
\subsubsection{\texorpdfstring{I\+C\+W4\+\_\+\+C\+PU}{ICW4\_CPU}}
{\footnotesize\ttfamily const uint8\+\_\+t P\+I\+C\+::\+I\+C\+W4\+\_\+\+C\+PU = 0x1}



8086/8088 mode 



Definition at line 71 of file interrupt.\+cpp.

\mbox{\Hypertarget{namespace_p_i_c_aae56765eb24eb75e1498e22c05ac29ee}\label{namespace_p_i_c_aae56765eb24eb75e1498e22c05ac29ee}} 
\index{P\+IC@{P\+IC}!M\+A\+S\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+D\+\_\+\+P\+O\+RT@{M\+A\+S\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+D\+\_\+\+P\+O\+RT}}
\index{M\+A\+S\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+D\+\_\+\+P\+O\+RT@{M\+A\+S\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+D\+\_\+\+P\+O\+RT}!P\+IC@{P\+IC}}
\subsubsection{\texorpdfstring{M\+A\+S\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+D\+\_\+\+P\+O\+RT}{MASTER\_COMMAND\_PORT}}
{\footnotesize\ttfamily const uint8\+\_\+t P\+I\+C\+::\+M\+A\+S\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+D\+\_\+\+P\+O\+RT = 0x20}



P\+I\+C1 command port. 



Definition at line 50 of file interrupt.\+cpp.

\mbox{\Hypertarget{namespace_p_i_c_a7b19e701740b8b1b19db1f1a14af63a6}\label{namespace_p_i_c_a7b19e701740b8b1b19db1f1a14af63a6}} 
\index{P\+IC@{P\+IC}!M\+A\+S\+T\+E\+R\+\_\+\+D\+A\+T\+A\+\_\+\+P\+O\+RT@{M\+A\+S\+T\+E\+R\+\_\+\+D\+A\+T\+A\+\_\+\+P\+O\+RT}}
\index{M\+A\+S\+T\+E\+R\+\_\+\+D\+A\+T\+A\+\_\+\+P\+O\+RT@{M\+A\+S\+T\+E\+R\+\_\+\+D\+A\+T\+A\+\_\+\+P\+O\+RT}!P\+IC@{P\+IC}}
\subsubsection{\texorpdfstring{M\+A\+S\+T\+E\+R\+\_\+\+D\+A\+T\+A\+\_\+\+P\+O\+RT}{MASTER\_DATA\_PORT}}
{\footnotesize\ttfamily const uint8\+\_\+t P\+I\+C\+::\+M\+A\+S\+T\+E\+R\+\_\+\+D\+A\+T\+A\+\_\+\+P\+O\+RT = 0x21}



P\+I\+C1 data port. 



Definition at line 53 of file interrupt.\+cpp.

\mbox{\Hypertarget{namespace_p_i_c_a4cdc374612119bd13b1a28e4cc82864f}\label{namespace_p_i_c_a4cdc374612119bd13b1a28e4cc82864f}} 
\index{P\+IC@{P\+IC}!S\+L\+A\+V\+E\+\_\+\+C\+O\+M\+M\+A\+N\+D\+\_\+\+P\+O\+RT@{S\+L\+A\+V\+E\+\_\+\+C\+O\+M\+M\+A\+N\+D\+\_\+\+P\+O\+RT}}
\index{S\+L\+A\+V\+E\+\_\+\+C\+O\+M\+M\+A\+N\+D\+\_\+\+P\+O\+RT@{S\+L\+A\+V\+E\+\_\+\+C\+O\+M\+M\+A\+N\+D\+\_\+\+P\+O\+RT}!P\+IC@{P\+IC}}
\subsubsection{\texorpdfstring{S\+L\+A\+V\+E\+\_\+\+C\+O\+M\+M\+A\+N\+D\+\_\+\+P\+O\+RT}{SLAVE\_COMMAND\_PORT}}
{\footnotesize\ttfamily const uint8\+\_\+t P\+I\+C\+::\+S\+L\+A\+V\+E\+\_\+\+C\+O\+M\+M\+A\+N\+D\+\_\+\+P\+O\+RT = 0x\+A0}



P\+I\+C2 command port. 



Definition at line 56 of file interrupt.\+cpp.

\mbox{\Hypertarget{namespace_p_i_c_a6e06fae4a0139a207173ff2b94be3283}\label{namespace_p_i_c_a6e06fae4a0139a207173ff2b94be3283}} 
\index{P\+IC@{P\+IC}!S\+L\+A\+V\+E\+\_\+\+D\+A\+T\+A\+\_\+\+P\+O\+RT@{S\+L\+A\+V\+E\+\_\+\+D\+A\+T\+A\+\_\+\+P\+O\+RT}}
\index{S\+L\+A\+V\+E\+\_\+\+D\+A\+T\+A\+\_\+\+P\+O\+RT@{S\+L\+A\+V\+E\+\_\+\+D\+A\+T\+A\+\_\+\+P\+O\+RT}!P\+IC@{P\+IC}}
\subsubsection{\texorpdfstring{S\+L\+A\+V\+E\+\_\+\+D\+A\+T\+A\+\_\+\+P\+O\+RT}{SLAVE\_DATA\_PORT}}
{\footnotesize\ttfamily const uint8\+\_\+t P\+I\+C\+::\+S\+L\+A\+V\+E\+\_\+\+D\+A\+T\+A\+\_\+\+P\+O\+RT = 0x\+A1}



P\+I\+C2 data port. 



Definition at line 59 of file interrupt.\+cpp.

